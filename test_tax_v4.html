
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ›å±‹ç¨…å‹™è¨ˆç®—å™¨ï¼ˆèˆŠæ›æ–°æˆæœ¬åˆ†æï¼‰</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f9;
      margin: 0;
      padding: 16px;
    }
    .wrap {
      max-width: 640px;
      margin: auto;
      background: #fff;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .row {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }
    .row label {
      flex: 0 0 180px;
      margin-bottom: 4px;
    }
    .row input[type="number"], .row select {
      flex: 1;
      padding: 6px;
      min-width: 120px;
      margin-right: 10px;
    }
    .dynamic-output {
      color: #888;
      font-size: 0.9em;
    }
    button {
      margin-top: 16px;
      width: 100%;
      padding: 10px;
      font-size: 1em;
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover { background: #0056b3; }
    .output-col {
      margin-top: 24px;
      font-size: 1.1em;
      color: #333;
    }
    .output-col span { color: #d33; font-weight: bold; }
  </style>
</head>
<body>
  <div class="wrap">
    <h2>æ›å±‹ç¨…å‹™è¨ˆç®—å™¨ï¼ˆèˆŠæ›æ–°æˆæœ¬åˆ†æï¼‰</h2>

    <div class="row">
      <label>èˆŠå±‹è²·åƒ¹ï¼ˆè¬å…ƒï¼‰</label>
      <input type="number" id="oldBuy" oninput="updateDisplay(this, 'oldBuyShow')" / oninput="updateDisplay(this, \'oldBuyShow\', \'è¬å…ƒ\')" /><span class="dynamic-output" id="oldBuyShow"></span>
      <span class="dynamic-output" id="oldBuyShow"></span>
    </div>

    <div class="row">
      <label>é¸æ“‡é ­æœŸæ¬¾æ–¹å¼</label>
      <select id="dpMode" onchange="toggleDPInput()">
        <option value="percent">è²¸æ¬¾æˆæ•¸</option>
        <option value="fixed">è¼¸å…¥é ­æœŸæ¬¾</option>
      </select>
    </div>

    <div class="row" id="dpPercentRow">
      <label>èˆŠå±‹è²¸æ¬¾æˆæ•¸ï¼ˆ%ï¼‰</label>
      <input type="number" id="loanPct" placeholder="80" oninput="updateDisplay(this, 'loanPctShow', '%')" / oninput="updateDisplay(this, \'loanPctShow\', \'%\')" /><span class="dynamic-output" id="loanPctShow"></span><span class="dynamic-output" id="loanPctShow"></span>
    </div>

    <div class="row" id="dpFixedRow" style="display:none;">
      <label>èˆŠå±‹é ­æœŸæ¬¾ï¼ˆè¬å…ƒï¼‰</label>
    <input type="number" id="downPayment" oninput="updateDisplay(this, 'downPaymentShow', 'è¬å…ƒ')" />
    <span class="dynamic-output" id="downPaymentShow"></span><span class="dynamic-output" id="downPaymentShow"></span><span class="dynamic-output" id="downPaymentShow"></span><span class="dynamic-output" id="downPaymentShow"></span>
    </div>

    <div class="row">
      <label>èˆŠå±‹è£æ½¢è²»ç”¨ï¼ˆè¬å…ƒï¼‰</label>
    <input type="number" id="decoration" oninput="updateDisplay(this, 'decorationShow', 'è¬å…ƒ')" />
    <span class="dynamic-output" id="decorationShow"></span><span class="dynamic-output" id="decorationShow"></span><span class="dynamic-output" id="decorationShow"></span><span class="dynamic-output" id="decorationShow"></span><span class="dynamic-output" id="decorationShow"></span>
    </div>

    <div class="row">
      <label>èˆŠå±‹è³£åƒ¹ï¼ˆè¬å…ƒï¼‰</label>
      <input type="number" id="oldSell" oninput="updateDisplay(this, 'oldSellShow')" / oninput="updateDisplay(this, \'oldSellShow\', \'è¬å…ƒ\')" /><span class="dynamic-output" id="oldSellShow"></span>
      <span class="dynamic-output" id="oldSellShow"></span>
    </div>

    <div class="row">
      <label>æŒæœ‰æœŸé–“ï¼ˆå¹´ï¼‰</label>
      <input type="number" step="0.1" id="holdYear" oninput="updateDisplay(this, 'holdShow', 'å¹´')" / oninput="updateDisplay(this, \'holdYearShow\', \'å¹´\')" /><span class="dynamic-output" id="holdYearShow"></span>
      <span class="dynamic-output" id="holdShow"></span>
    </div>

    <div class="row">
      <label>æ–°å±‹è²·åƒ¹ï¼ˆè¬å…ƒï¼‰</label>
      <input type="number" id="newBuy" oninput="updateDisplay(this, 'newBuyShow')" / oninput="updateDisplay(this, \'newBuyShow\', \'è¬å…ƒ\')" /><span class="dynamic-output" id="newBuyShow"></span>
      <span class="dynamic-output" id="newBuyShow"></span>
    </div>

    <div class="row">
      <input type="checkbox" id="selfUse" />
      <label for="selfUse">ç¬¦åˆé‡è³¼é€€ç¨…æ¢ä»¶ï¼ˆâ‰¤â€¯2 å¹´ã€è‡ªä½ã€ä¸å‡ºç§Ÿï¼‰</label>
    </div>

    <button onclick="calcTax()">è¨ˆç®—ç¨…å‹™</button>

    <div class="output-col">
      <h2>ç¨…å‹™çµæœ</h2>
      <div id="taxResult">è«‹è¼¸å…¥è³‡æ–™ä¸¦é»æ“Šè¨ˆç®—</div>
    </div>
  </div>

  <script>
function updateDisplay(input, targetId, unit = 'è¬å…ƒ') {
  const value = input.value;
  document.getElementById(targetId).innerText = value ? `${value} ${unit}` : '';
}
</script>
<script>
    function updateDisplay(input, targetId, unit = 'è¬å…ƒ') {
      const value = input.value;
      document.getElementById(targetId).innerText = value ? `${value} ${unit}` : '';
    }

    function toggleDPInput() {
      const mode = document.getElementById("dpMode").value;
      document.getElementById("dpPercentRow").style.display = mode === "percent" ? "flex" : "none";
      document.getElementById("dpFixedRow").style.display = mode === "fixed" ? "flex" : "none";
    }

    function calcTax() {
      const ob = +document.getElementById('oldBuy').value * 10000;
      const os = +document.getElementById('oldSell').value * 10000;
      const nbInput = document.getElementById('newBuy').value;
      const nb = +nbInput * 10000;
      const hy = +document.getElementById('holdYear').value;
      const su = document.getElementById('selfUse').checked;
      const dpMode = document.getElementById('dpMode').value;
      const dp = +document.getElementById('downPayment').value * 10000;
      const loanPct = +document.getElementById('loanPct').value;
      const deco = +document.getElementById('decoration').value * 10000 || 0;
      const out = document.getElementById('taxResult');

      if (!ob || !os || hy <= 0) {
        out.innerHTML = 'ğŸ›‘ è«‹è¼¸å…¥èˆŠå±‹è²·åƒ¹ã€èˆŠå±‹è³£åƒ¹èˆ‡æŒæœ‰æœŸé–“';
        return;
      }

      const down = (dpMode === 'fixed') ? dp : (ob * (1 - loanPct / 100));
      const gain = os - ob;
      let rate = hy <= 2 ? 0.45 : hy < 5 ? 0.35 : hy < 10 ? 0.20 : 0.15;
      const rawTax = gain * rate;

      let refund = 0, refundMsg = '';
      if (nbInput) {
        if (su && hy > 2) {
          out.innerHTML = 'âš ï¸ è¶…é2å¹´æŒæœ‰æœŸé–“ï¼Œä¸å¯ç”³è«‹é‡è³¼é€€ç¨…';
          return;
        }
        if (su) {
          refund = nb >= os ? rawTax : rawTax * (nb / os);
          refundMsg = `<b>å¯é€€ç¨…é¡ï¼š</b>${(refund / 10000).toFixed(1)} è¬å…ƒ<br>`;
        }
      }

      const finalTax = rawTax - refund;
      const netProfit = gain - down - deco - finalTax;

      out.innerHTML = `
        <b>è³‡æœ¬åˆ©å¾—ï¼š</b>${(gain / 10000).toFixed(1)} è¬å…ƒ<br>
        <b>é©ç”¨ç¨…ç‡ï¼š</b>${(rate * 100).toFixed(0)}%<br>
        <b>åŸå§‹æ‡‰ç´æˆ¿åœ°åˆä¸€ç¨…ï¼š</b>${(rawTax / 10000).toFixed(1)} è¬å…ƒ<br>
        ${refundMsg}
        <b><u>æœ€çµ‚æ‡‰ç¹³ç¨…é¡ï¼š</u></b><span>${(finalTax / 10000).toFixed(1)} è¬å…ƒ</span><br>
        <b>æ·¨åˆ©ï¼ˆæ–°èˆŠåƒ¹å·® - é ­æœŸæˆæœ¬ - å…¶ä»–è²»ç”¨ - ç¨…ï¼‰ï¼š</b><span>${(netProfit / 10000).toFixed(1)} è¬å…ƒ</span>
      `;
    }
  </script>

    <hr style="margin-top:40px; margin-bottom:20px;">
    <div class="output-col">
      <h3>ğŸ“Œ å‚™è¨»èªªæ˜</h3>
      <p><b>1. æˆ¿å±‹åˆä¸€ç¨…å…¬å¼ï¼š</b><br>
        è³‡æœ¬åˆ©å¾— Ã— é©ç”¨ç¨…ç‡ï¼ˆä¾æŒæœ‰æœŸé–“ï¼‰<br>
        â–¸ æŒæœ‰ â‰¦2 å¹´ï¼š45%<br>
        â–¸ 2-5 å¹´ï¼š35%<br>
        â–¸ 5-10 å¹´ï¼š20%<br>
        â–¸ â‰§10 å¹´ï¼š15%</p>

      <p><b>2. é‡è³¼é€€ç¨…æ¢ä»¶èˆ‡å…¬å¼ï¼š</b><br>
        âœ… åŸå±‹å”®å‡ºå¾Œï¼Œ1 å¹´å…§è³¼è²·æ–°å±‹ï¼ˆæˆ–æ–°å±‹å¾Œ 2 å¹´å…§å”®å‡ºåŸå±‹ï¼‰<br>
        âœ… å¿…é ˆç‚ºè‡ªä½æˆ¿å±‹ï¼ˆç„¡å‡ºç§Ÿç´€éŒ„ï¼‰<br>
        âœ… å¿…é ˆæŒæœ‰ â‰¦2 å¹´<br>
        <br>
        <b>é€€ç¨…é‡‘é¡ï¼š</b><br>
        â–¸ è‹¥æ–°å±‹åƒ¹æ ¼ â‰§ èˆŠå±‹è³£åƒ¹ âœ é€€å…¨éƒ¨æˆ¿åœ°åˆä¸€ç¨…<br>
        â–¸ è‹¥æ–°å±‹åƒ¹æ ¼ ï¼œ èˆŠå±‹è³£åƒ¹ âœ ä¾æ¯”ä¾‹é€€ç¨…ï¼š<br>
        ï¼ˆæ–°å±‹è²·åƒ¹ Ã· èˆŠå±‹è³£åƒ¹ï¼‰ Ã— åŸç¨…é¡
      </p>
    </div>
  </div>
</body>
</html>

